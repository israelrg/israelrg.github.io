<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">ğŸ“„ Cluster PCS LVM | Filesystem | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.israelrodriguez.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.israelrodriguez.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ğŸ“„ Cluster PCS LVM | Filesystem | My Site"><meta data-rh="true" name="description" content="2025-08-23"><meta data-rh="true" property="og:description" content="2025-08-23"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem"><link data-rh="true" rel="alternate" href="https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“ DocumentaciÃ³n IT","item":"https://www.israelrodriguez.xyz/documentacion_it/"},{"@type":"ListItem","position":2,"name":"ğŸ“ Clusters de alta disponibilidad RedHat","item":"https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/"},{"@type":"ListItem","position":3,"name":"ğŸ“„ Cluster PCS LVM | Filesystem","item":"https://www.israelrodriguez.xyz/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/assets/css/styles.b7fd2066.css">
<script src="/assets/js/runtime~main.acc70093.js" defer="defer"></script>
<script src="/assets/js/main.8664d261.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Israel RodrÃ­guez</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="ğŸŸ  Inicio" class="linkLabel_WmDU">ğŸŸ  Inicio</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/documentacion_it/"><span title="ğŸ“ DocumentaciÃ³n IT" class="categoryLinkLabel_W154">ğŸ“ DocumentaciÃ³n IT</span></a><button aria-label="Collapse sidebar category &#x27;ğŸ“ DocumentaciÃ³n IT&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/documentacion_it/high_availability_clusters_docs/"><span title="ğŸ“ Clusters de alta disponibilidad RedHat" class="categoryLinkLabel_W154">ğŸ“ Clusters de alta disponibilidad RedHat</span></a><button aria-label="Collapse sidebar category &#x27;ğŸ“ Clusters de alta disponibilidad RedHat&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentacion_it/high_availability_clusters_docs/InstalaciÃ³n"><span title="ğŸ“„ InstalaciÃ³n pacemaker | corosync" class="linkLabel_WmDU">ğŸ“„ InstalaciÃ³n pacemaker | corosync</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentacion_it/high_availability_clusters_docs/pcs_resources"><span title="ğŸ“„ ConfiguraciÃ³n de recursos de cluster" class="linkLabel_WmDU">ğŸ“„ ConfiguraciÃ³n de recursos de cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentacion_it/high_availability_clusters_docs/pcs_lvm_filesystem"><span title="ğŸ“„ Cluster PCS LVM | Filesystem" class="linkLabel_WmDU">ğŸ“„ Cluster PCS LVM | Filesystem</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/documentacion_it/miscelanea/"><span title="ğŸ“ Miscelanea" class="categoryLinkLabel_W154">ğŸ“ Miscelanea</span></a><button aria-label="Collapse sidebar category &#x27;ğŸ“ Miscelanea&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentacion_it/miscelanea/kerberos"><span title="ğŸ“„ ConfiguraciÃ³n de SSH + kerberos" class="linkLabel_WmDU">ğŸ“„ ConfiguraciÃ³n de SSH + kerberos</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentacion_it/miscelanea/lpic_102_exam"><span title="ğŸ“„ LPI 102 - Apuntes examen" class="linkLabel_WmDU">ğŸ“„ LPI 102 - Apuntes examen</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentacion_it/miscelanea/sortear_conexiones_ssh"><span title="ğŸ“„ Sortear conexiones detrÃ¡s de firewall via SSH" class="linkLabel_WmDU">ğŸ“„ Sortear conexiones detrÃ¡s de firewall via SSH</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/documentacion_ecom/"><span title="ğŸ“ DocumentaciÃ³n EconomÃ­a" class="linkLabel_WmDU">ğŸ“ DocumentaciÃ³n EconomÃ­a</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/documentacion_it/"><span>ğŸ“ DocumentaciÃ³n IT</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/documentacion_it/high_availability_clusters_docs/"><span>ğŸ“ Clusters de alta disponibilidad RedHat</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ğŸ“„ Cluster PCS LVM | Filesystem</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cluster PCS LVM | Filesystem</h1></header>
<span class="badge badge--primary">2025-08-23</span>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="resumen">Resumen<a href="#resumen" class="hash-link" aria-label="Direct link to Resumen" title="Direct link to Resumen" translate="no">â€‹</a></h2>
<p><img decoding="async" loading="lazy" alt="image" src="/assets/images/a1-e41ac0e03c24d99cf109ec7d082b89c2.png" width="3852" height="1938" class="img_ev3q"></p>
<p>Este manual documenta cÃ³mo crear un recurso de tipo LVM y sistema de archivos en un clÃºster RH10 utilizando PCS. Se parte de la base del entorno creado en la secciÃ³n de <a class="" href="/documentacion_it/high_availability_clusters_docs/InstalaciÃ³n">instalaciÃ³n</a>.</p>
<p>Para la creaciÃ³n de un recurso LVM, es necesario crear primero un dispositivo de bloque iSCSI accesible desde ambos nodos del clÃºster. Este manual no profundiza en cÃ³mo crear un dispositivo de estas caracterÃ­sticas.</p>
<p>Este documento se basa en la <a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters" target="_blank" rel="noopener noreferrer" class="">guÃ­a oficial de Red Hat</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-importar-disco-iscsi">1. Importar disco iSCSI<a href="#1-importar-disco-iscsi" class="hash-link" aria-label="Direct link to 1. Importar disco iSCSI" title="Direct link to 1. Importar disco iSCSI" translate="no">â€‹</a></h2>
<p>Para este laboratorio, he creado un tercer servidor que actÃºa como servidor de almacenamiento. Este servidor ejecuta TrueNAS, el cual exporta un dispositivo de bloque de 10 GB. Este disco serÃ¡ accesible desde ambos nodos. En un entorno de producciÃ³n, estos recursos de almacenamiento deben estar redundados, pero en este caso lo omitiremos.</p>
<p>A continuaciÃ³n, se presentan los comandos que he utilizado para aÃ±adir el nuevo dispositivo de bloque iSCSI:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Descubrir y listar IQNs disponibles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# iscsiadm -m discovery -t sendtargets -p 10.10.10.7 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10.10.10.7:3260,1 iqn.2005-10.org.freenas.ctl:extent1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Acceso y login al export</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# iscsiadm -m node -T iqn.2005-10.org.freenas.ctl:extent1 -p 10.10.10.7 -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logging in to [iface: default, target: iqn.2005-10.org.freenas.ctl:extent1, portal: 10.10.10.7,3260]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Login to [iface: default, target: iqn.2005-10.org.freenas.ctl:extent1, portal: 10.10.10.7,3260] successful.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Login automÃ¡tico en boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# iscsiadm -m node -T iqn.2005-10.org.freenas.ctl:extent1 -p 10.10.10.7 --op update -n node.startup -v automatic</span><br></span></code></pre></div></div>
<p>Una vez conectado al servidor, el disco deberÃ­a aparecer disponible.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# lsblk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sda                  8:0    0   50G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€sda1               8:1    0  600M  0 part /boot/efi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€sda2               8:2    0    1G  0 part /boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€sda3               8:3    0 48.4G  0 part </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€almalinux-root 253:0    0 43.4G  0 lvm  /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€almalinux-swap 253:1    0    5G  0 lvm  [SWAP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sdb                  8:16   0   10G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sr0                 11:0    1  6.8G  0 rom  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node2:~# lsblk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sda                      8:0    0   50G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€sda1                   8:1    0  600M  0 part /boot/efi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€sda2                   8:2    0    1G  0 part /boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€sda3                   8:3    0 48.4G  0 part </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€almalinux_192-root 253:0    0 43.4G  0 lvm  /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€almalinux_192-swap 253:1    0    5G  0 lvm  [SWAP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sdb                      8:16   0   10G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sr0                     11:0    1  6.8G  0 rom  </span><br></span></code></pre></div></div>
<p>AquÃ­ tienes el texto corregido y mejorado:</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-crear-lvm-y-sistema-de-archivos">2. Crear LVM y sistema de archivos<a href="#2-crear-lvm-y-sistema-de-archivos" class="hash-link" aria-label="Direct link to 2. Crear LVM y sistema de archivos" title="Direct link to 2. Crear LVM y sistema de archivos" translate="no">â€‹</a></h2>
<p>En primer lugar, se debe aÃ±adir la siguiente lÃ­nea de configuraciÃ³n en <code>/etc/lvm/lvm.conf</code>.</p>
<p>El <strong>SystemID</strong> en LVM es un identificador que restringe el acceso a un VG a un solo host, evitando que mÃºltiples hosts utilicen el VG simultÃ¡neamente. Esta caracterÃ­stica es Ãºtil cuando los VGs se colocan en dispositivos de almacenamiento compartido, asegurando que solo el host con el ID del sistema coincidente pueda acceder al VG.</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">/etc/lvm/lvm.conf</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token maybe-class-name">Configuration</span><span class="token plain"> option global</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">system_id_source</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property-access">system_id_source</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;uname&quot;</span><br></span></code></pre></div></div>
<p>ComprobaciÃ³n de la configuraciÃ³n.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# lvm dumpconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activation {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">global {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	system_id_source=&quot;uname&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shell {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# lvm systemid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  system ID: node1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="crear-pv-vg-lv">Crear PV, VG, LV<a href="#crear-pv-vg-lv" class="hash-link" aria-label="Direct link to Crear PV, VG, LV" title="Direct link to Crear PV, VG, LV" translate="no">â€‹</a></h3>
<p>Los siguientes comandos se ejecutarÃ¡n Ãºnicamente en un nodo, dado que el disco es el mismo para ambos nodos.</p>
<table><thead><tr><th>PV</th><th>VG</th><th>LV</th></tr></thead><tbody><tr><td><code>/dev/sdb</code></td><td><code>vg01</code></td><td><code>my_lv</code></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>&quot;La opciÃ³n <code>--setautoactivation n</code> durante la creaciÃ³n del <strong>VG</strong> se utiliza para evitar que el sistema active los recursos al arrancar por defecto. <a href="https://www.man7.org/linux/man-pages/man8/vgcreate.8.html" target="_blank" rel="noopener noreferrer" class="">Enlace a la documentaciÃ³n</a>.&quot;</p></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Crear PV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# pvcreate /dev/sdb </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Physical volume &quot;/dev/sdb&quot; successfully created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# pvs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PV         VG        Fmt  Attr PSize  PFree </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /dev/sda3  almalinux lvm2 a--  48.41g     0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /dev/sdb             lvm2 ---  10.00g 10.00g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Crear VG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# vgcreate --setautoactivation n vg01 /dev/sdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Volume group &quot;vg01&quot; successfully created with system ID node1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# vgs -o+systemid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VG        #PV #LV #SN Attr   VSize  VFree System ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  almalinux   1   2   0 wz--n- 48.41g    0           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vg01        1   0   0 wz--n- 10.00g    0  node1    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Crear LV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# lvcreate -n my_lv -l 100%FREE vg01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Logical volume &quot;my_lv&quot; created.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="crear-y-montar-fs">Crear y montar FS<a href="#crear-y-montar-fs" class="hash-link" aria-label="Direct link to Crear y montar FS" title="Direct link to Crear y montar FS" translate="no">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# mkfs.xfs /dev/vg01/my_lv </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">specified blocksize 4096 is less than device physical sector size 16384</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">switching to logical sector size 4096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta-data=/dev/vg01/my_lv        isize=512    agcount=4, agsize=639488 blks</span><br></span></code></pre></div></div>
<p>Una vez creado el sistema de archivos, monta el sistema de archivos y aÃ±adir la web que debe estar en alta disponibilidad.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-crear-los-recursos-de-cluster">3. Crear los recursos de cluster<a href="#3-crear-los-recursos-de-cluster" class="hash-link" aria-label="Direct link to 3. Crear los recursos de cluster" title="Direct link to 3. Crear los recursos de cluster" translate="no">â€‹</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Crear recurso LVM-activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create my_lvm ocf:heartbeat:LVM-activate vgname=vg01 vg_access_mode=system_id --group apachegroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Crear recurso Filesystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pcs resource create my_fs Filesystem device=&quot;/dev/vg01/my_lv&quot; directory=&quot;/var/www&quot; fstype=&quot;xfs&quot; --group apachegroup</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# lsblk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sdb                  8:16   0  9.8G  0 disk </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€vg01-my_lv       253:2    0  9.8G  0 lvm  /var/www</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@node1:~# pcs resource status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Resource Group: apachegroup:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * VirtualIP	(ocf:heartbeat:IPaddr2):	 Started node1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * my_lvm	(ocf:heartbeat:LVM-activate):	 Started node1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * my_fs	(ocf:heartbeat:Filesystem):	 Started node1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  * Clone Set: Website-clone [Website]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Started: [ node1 node2 ]</span><br></span></code></pre></div></div>
<p>Si accedemos a la web desde la <strong>VIP</strong>, deberÃ­amos ver la web activa. Para comprobar que el balanceo funciona correctamente, ejecutar <code>pcs node unstandby node1</code>.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/documentacion_it/high_availability_clusters_docs/pcs_resources"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ğŸ“„ ConfiguraciÃ³n de recursos de cluster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/documentacion_it/miscelanea/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ğŸ“ Miscelanea</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#resumen" class="table-of-contents__link toc-highlight">Resumen</a></li><li><a href="#1-importar-disco-iscsi" class="table-of-contents__link toc-highlight">1. Importar disco iSCSI</a></li><li><a href="#2-crear-lvm-y-sistema-de-archivos" class="table-of-contents__link toc-highlight">2. Crear LVM y sistema de archivos</a><ul><li><a href="#crear-pv-vg-lv" class="table-of-contents__link toc-highlight">Crear PV, VG, LV</a></li><li><a href="#crear-y-montar-fs" class="table-of-contents__link toc-highlight">Crear y montar FS</a></li></ul></li><li><a href="#3-crear-los-recursos-de-cluster" class="table-of-contents__link toc-highlight">3. Crear los recursos de cluster</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">CompilaciÃ³n de 2025</div></div></div></footer></div>
</body>
</html>