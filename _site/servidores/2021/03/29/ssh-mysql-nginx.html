<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/assets/normalize.css">
  <link rel="stylesheet" href="/assets/open-color.css">
  <link rel="stylesheet" href="/assets/monophase/styles.css">
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="safs" />
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>ssh, mysql, nginx | safs</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="ssh, mysql, nginx" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Escribiré un poco de todo por que no tengo ganas de mirar lxc. Estos días estuve probando a hostear mi propio servidor para writefreely y no tener que pagar la suscripción. Estuve haciendo pruebas en una maquina virtual en Azure y creo que sería interesante escribir sobre como voy en ello." />
<meta property="og:description" content="Escribiré un poco de todo por que no tengo ganas de mirar lxc. Estos días estuve probando a hostear mi propio servidor para writefreely y no tener que pagar la suscripción. Estuve haciendo pruebas en una maquina virtual en Azure y creo que sería interesante escribir sobre como voy en ello." />
<link rel="canonical" href="http://localhost:4000/servidores/2021/03/29/ssh-mysql-nginx.html" />
<meta property="og:url" content="http://localhost:4000/servidores/2021/03/29/ssh-mysql-nginx.html" />
<meta property="og:site_name" content="safs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-29T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ssh, mysql, nginx" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/servidores/2021/03/29/ssh-mysql-nginx.html","headline":"ssh, mysql, nginx","dateModified":"2021-03-29T00:00:00+02:00","datePublished":"2021-03-29T00:00:00+02:00","description":"Escribiré un poco de todo por que no tengo ganas de mirar lxc. Estos días estuve probando a hostear mi propio servidor para writefreely y no tener que pagar la suscripción. Estuve haciendo pruebas en una maquina virtual en Azure y creo que sería interesante escribir sobre como voy en ello.","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/servidores/2021/03/29/ssh-mysql-nginx.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>
  
  

</head>

  <body>
    <div class="container">
      <header class="masthead">
  <div class="masthead-title">
    <a href="/" title="Home">safs</a>
    <small class="tagline"></small>
  </div>

  
</header>


      <main>
        <article class="post">
  <h1 class="post-title">ssh, mysql, nginx</h1>
  <div class="post-meta">
    <time datetime="2021-03-29T00:00:00+02:00" itemprop="datePublished">
      29 Mar 2021
    </time><span> ~ </span><time datetime="2021-03-29T00:00:00+02:00" itemprop="dateModified">
        29 Mar 2021
      </time>
      <span> • </span>
      <span class="post-categories-section">
        <i class="post-categories-icon fas fa-folder"></i>
        <ul class="post-categories"><li>
              <span class="post-category">Servidores</span></li></ul>
      </span>
    
    
      <span> • </span>
      <span class="post-tags-section">
        <i class="post-tags-icon fas fa-tag"></i>
        <ul class="post-tags"><li>
              <span class="post-tag">ssh-mysql-nginx</span></li></ul>
      </span>
    
  </div>

  <p>Escribiré un poco de todo por que no tengo ganas de mirar lxc.
Estos días estuve probando a hostear mi propio servidor para writefreely y no tener que pagar la suscripción. Estuve haciendo pruebas en una maquina virtual en Azure y creo que sería interesante escribir sobre como voy en ello.</p>

<p>La creación de la maquina es francamente sencilla. Lo hice con la interfaz que te dan ellos en Azure Portal. Por la linea de comandos propia de Azure no me puse a investigar. Al crear una nueva cuenta te dan 170$ para gastar en un mes, lo suficiente para hacer pruebas y jugar con servidores remotos.</p>

<h2 id="conexiones-ssh">Conexiones ssh</h2>
<p>Una vez creas la maquina importante abrirle los puertos para http y https. Se hace en una ventana que pone <strong>networking</strong>, easy. Nos descargamos un archivo *.pem. Super importante, con el haremos la conexión:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">ssh -i archivo.pem user@ip</code></pre></figure>

<p>Y con eso ya estariamos dentro.
Para enviar archivos al servido directamente con ssh hacemos:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">scp -i archivo.pem files user@ip:/home/user</code></pre></figure>

<p>Los dos puntos para especificar la ruta. Si hacemos a /root nos va a dar error de permiso, tenerlo en cuenta a la hora de iniciar sesion ssh.</p>

<h2 id="crear-usuarios-mysql">Crear usuarios mysql</h2>
<p>Para hostear yo mismo la página necesitaba configurar la base de datos.</p>
<ul>
  <li>Crear usuarios</li>
</ul>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">CREATE USER 'user'@'localhost' IDENTIFIED BY 'password'</code></pre></figure>

<ul>
  <li>Darle todos los permisos a ese usuario</li>
</ul>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">GRANT ALL PRIVILEGES ON * . * to 'user'@'localhost'</code></pre></figure>

<p>Tener en cuenta poner localhost y no poner el nombre de la maquina. A mi me dio problemas por ello.</p>

<h2 id="proxy-inverso-con-nginx">Proxy inverso con NGINX</h2>
<p>Generar la pagina me daba error. Si configuraba apache2 en el servidor y lo levantaba, me accedía siendo yo el cliente. Una mala configuración de los puertos en Azure quedaba descartado. Lo unico que me aparecia era SSL internal error y dentro del servidor me daba errores muy complejos. Con un poco de paciencia configure un proxy inverso con ngix.
La configuración esta en un archivo dentro de /etc/nginx/conf.d.
Puede haber un default.conf, en mi caso no lo había. No voy a explicar el funcionamiento de este archivo porque me tiraría buen rato explicando codigo que basicamente está en la documentación propia de nginx.
<img src="/assets/screenshots/29_03_2021_1.png" alt="imagen" />
Lo unico que hice es transladar el trafico de mi localhost:8080 que es donde esta corriendo mi servicio al localhost:80 cada vez que se accede a la web con la ip. Podemos configurar dominios y diferentes páginas. Yo para checkear que todo funcionase puese la ip. 
PRO-TIP: Para comprobar que el archivo .conf esté bien escrito, en cosola ponemos nginx -t. Por pantalla nos debería de salir “Succesfull”
<img src="/assets/screenshots/29_03_2021_2.png" alt="imagen" /></p>



  
</article>


  <aside class="related">
    <h2 class="related-title">Related posts</h2>
    <ul class="related-posts">
      
        <li>
          <a href="/jekyll/update/2021/05/15/welcome-to-jekyll.html">
            Welcome to Jekyll!
          </a>
          <small><time datetime="2021-05-15T17:14:38+02:00">15 May 2021</time></small>
        </li>
      
        <li>
          <a href="/facebook%20leak/2021/04/14/facebook-leak-1.html">
            Facebook leak #1
          </a>
          <small><time datetime="2021-04-14T00:00:00+02:00">14 Apr 2021</time></small>
        </li>
      
        <li>
          <a href="/lxc/2021/03/26/lxc2.html">
            LXC #2
          </a>
          <small><time datetime="2021-03-26T00:00:00+01:00">26 Mar 2021</time></small>
        </li>
      
    </ul>
  </aside>


      </main>

      <footer class="footer">
  <div class="footer-column">
    <p>
      <small>
        &copy;&nbsp;<time datetime="2021-05-15T18:26:30+02:00">2021</time>. All right reserved.
      </small>
    </p>
    <p>
      <small>
        Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> & <a href="https://github.com/zivhub/monophase" target="_blank">Monophase</a>
      </small>
    </p>
  </div>
  
</footer>

    </div>

    

    
  </body>
</html>
